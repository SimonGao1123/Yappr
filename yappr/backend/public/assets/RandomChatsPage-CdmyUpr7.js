import{r as u,j as a}from"./index-DKNOk5to.js";function x({currentUser:e}){const[n,t]=u.useState(0),[o,i]=u.useState(),[l,s]=u.useState(),[h,c]=u.useState(null);return console.log(n),u.useEffect(()=>{if(!e?.id)return;r(e.id,t,i,s,c);const d=setInterval(()=>{r(e.id,t,i,s,c)},1500);return()=>clearInterval(d)},[e?.id]),a.jsx(a.Fragment,{children:n==0?a.jsx(g,{currentUser:e,setStatus:t}):n==1?a.jsx(f,{currentUser:e,queueSize:h,setStatus:t,setCurrChatData:i,setMessageData:s}):a.jsx(a.Fragment,{})})}function g({currentUser:e,setStatus:n}){return a.jsxs(a.Fragment,{children:[a.jsx("h3",{children:"Currently not in Queue"}),a.jsx("button",{onClick:()=>m(e.id,n),children:"Join Queue"})]})}function f({currentUser:e,queueSize:n,setStatus:t,setCurrChatData:o,setMessageData:i}){return a.jsxs(a.Fragment,{children:[a.jsx("h3",{children:"Currently waiting in Queue"}),a.jsxs("p",{children:["There are: ",n||"Loading..."," people in queue"]}),a.jsx("button",{onClick:()=>j(e.id,t,o,i),children:"Leave Queue"})]})}function j(e,n,t,o){fetch("/api/randomChats/leaveQueue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:e})}).then(async i=>{const l=await i.json();l.success&&(n(0),t(null),o(null)),console.log(l.message)}).catch(i=>{console.log(i)})}function m(e,n){fetch("/api/randomChats/joinQueue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:e})}).then(async t=>{const o=await t.json();console.log(o.message),o.success&&n(1)}).catch(t=>{console.log(t)})}function r(e,n,t,o,i){fetch(`/api/randomChats/getRandomChat/${e}`).then(async l=>{const s=await l.json();if(!s.success){console.log(s.message);return}s.waiting==!1&&s.inChat==!1?(n(0),t(null),o(null)):s.waiting==!0&&s.inChat==!1?(n(1),t(null),o(null),i(s.queueSize??null)):s.inChat==!0&&(n(2),t(s.chatData??null),o(s.messages??null)),console.log(s.message)}).catch(l=>{console.log(l)})}export{x as default};
